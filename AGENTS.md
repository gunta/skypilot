# Repository Guidelines

## Project Structure & Module Organization
Source lives in `src/`. Core API helpers are in `src/api.ts`, the Commander CLI entry point is `src/cli.ts`, the Ink UI is under `src/tui/`, and a library surface is exposed through `src/index.ts`. Release automation scripts reside in `scripts/`. Persistent settings and cached exchange rates live in `src/storage/` (Drizzle ORM + Turso/libsql) and are written to `~/.sky-pilot/settings.db`. Keep build artifacts generated by `bun run build` under `dist/` (already gitignored) and avoid committing downloaded videos or other large assets.

## Build, Test, and Development Commands
- `bun install` — install dependencies and sync `bun.lock`.
- `bun run typecheck` — ensure TypeScript passes in strict mode.
- `bun run build` — compile the publishable ESM bundle into `dist/`.
- `bun run src/cli.ts …` — run the CLI directly during development (mirrors the published `sky-pilot` binary).
- `bun run generate:changelog` — craft AI-authored release notes for the next version.
Run commands from the repository root so `tsconfig.json` is honored.

## Coding Style & Naming Conventions
Use TypeScript with two-space indentation and semicolons. Prefer `const` for immutable bindings and `camelCase` for symbols. Keep shared utilities in `src/api.ts` (or new modules within `src/`) and avoid duplicating OpenAI client setup. Locale/currency helpers live in `src/locale/`—reuse them rather than reimplementing detection logic. When referencing files from the CLI that must work after compilation, import the `.js` extension explicitly so Node-friendly specifiers are emitted. Reinforce in any UI copy that Sky Pilot is an unofficial GUI and not affiliated with OpenAI.

All user-facing strings should be added to the Paraglide message catalog (`messages/<locale>.json`) and consumed via the generated helpers in `src/paraglide/messages`. Whenever you add or rename a message, rerun `bunx paraglide-js compile --project ./project.inlang --outdir ./src/paraglide` and provide translations for English and Japanese.

## Testing Guidelines
Dedicated automated tests are not yet defined. For manual verification, exercise `bun run src/cli.ts create --prompt "..." --watch`, monitor progress in the TUI with `bun run src/cli.ts tui`, and confirm downloads via `bun run src/cli.ts download <video-id>`. Document any additional manual checks in pull requests until a formal test suite is introduced.

## Commit & Pull Request Guidelines
Follow Conventional Commit prefixes (`feat:`, `fix:`, `docs:`, etc.) to keep history tidy. PR descriptions should summarize user-facing changes, list validation commands, and mention any impacts on release automation or OpenAI usage. Update `README.md` or `CHANGELOG.md` when behavior or workflows change.

## Security & Configuration Tips
Export `OPENAI_API_KEY` in your shell or a gitignored `.env`. Never commit credentials or generated media. If you add new environment variables, document them in `README.md` and ensure the release scripts surface clear errors when they are missing.
